/*
 * PortfoliioJPanel.java
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or (at
 * your option) any later version.
 *
 * This program is distributed in the hope that it will be useful, but
 * WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
 *
 * Copyright (C) 2008 Cheok YanCheng <yccheok@yahoo.com>
 */

package org.yccheok.jstock.gui;

import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;

import org.yccheok.jstock.portfolio.*;
import org.yccheok.jstock.engine.*;
import org.yccheok.jstock.gui.treetable.*;

/**
 *
 * @author  Owner
 */
public class PortfolioManagementJPanel extends javax.swing.JPanel implements ChangeListener {
    
    /** Creates new form PortfoliioJPanel */
    public PortfolioManagementJPanel() {
        initComponents();        
        
        this.initJTreeTable();
    }
    
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel2 = new javax.swing.JPanel();
        jButton1 = new javax.swing.JButton();
        jButton2 = new javax.swing.JButton();
        jPanel1 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();

        setLayout(new java.awt.BorderLayout());

        jButton1.setText("New Trasaction...");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });
        jPanel2.add(jButton1);

        jButton2.setText("Delete Transaction");
        jPanel2.add(jButton2);

        add(jPanel2, java.awt.BorderLayout.SOUTH);

        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder("Portfolio Management"));
        jPanel1.setLayout(new java.awt.BorderLayout());
        jPanel1.add(jScrollPane1, java.awt.BorderLayout.CENTER);

        add(jPanel1, java.awt.BorderLayout.CENTER);
    }// </editor-fold>//GEN-END:initComponents

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        // TODO add your handling code here:
        if(jTable1 instanceof org.yccheok.jstock.gui.treetable.JTreeTable) {
            final org.yccheok.jstock.gui.treetable.JTreeTable jTreeTable = (org.yccheok.jstock.gui.treetable.JTreeTable)jTable1;
            final TreeTableModel treeTableModel = jTreeTable.getTreeTableModel();
            
            if(treeTableModel instanceof PortfolioTreeTableModel) {
                final PortfolioTreeTableModel portfolioTreeTableModel = (PortfolioTreeTableModel)treeTableModel;
                System.out.println("Transaction added");
                
              
                
                Contract contract = new Contract(
                        Utils.getEmptyStock("1234", "pbbank"), 
                        new SimpleDate(2008, 0, 31), 
                        Contract.Type.Buy, 
                        1000, 
                        2.00);
                
                Broker broker = new SimpleBroker("SimpleBroker", 1000, 100, 2.0);
                
                StampDuty stampDuty = new SimpleStampDuty("SimpleStampDuty", 1000, 100, 2.0);
               
                ClearingFee clearingFee = new SimpleClearingFee("SimpleClearingfee", 1000, 100, 2.0);
                        
                Transaction transaction = new Transaction(contract, broker, stampDuty, clearingFee);
                
                portfolioTreeTableModel.addTransaction(transaction);                
            }
        }
    }//GEN-LAST:event_jButton1ActionPerformed
    
    private void initJTreeTable() {
        jTable1 = new org.yccheok.jstock.gui.treetable.JTreeTable();
        jTable1.setAutoResizeMode(javax.swing.JTable.AUTO_RESIZE_OFF);
        jTable1.getTableHeader().addMouseListener(new TableColumnSelectionPopupListener(1)); 
        this.jScrollPane1.setViewportView(jTable1);
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JScrollPane jScrollPane1;
    // End of variables declaration//GEN-END:variables

    private javax.swing.JTable jTable1;
            
    public void stateChanged(ChangeEvent e) {
        throw new UnsupportedOperationException("Not supported yet.");
    }    
}
